(()=>{var e={};e.id=276,e.ids=[276],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1820:e=>{"use strict";e.exports=require("os")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},4573:e=>{"use strict";e.exports=require("node:buffer")},4631:e=>{"use strict";e.exports=require("tls")},4735:e=>{"use strict";e.exports=require("events")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4985:e=>{"use strict";e.exports=require("dns")},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},6330:e=>{"use strict";e.exports=require("@prisma/client")},6487:()=>{},6541:e=>{"use strict";e.exports=require("@prisma/client/runtime/library")},7113:(e,r,t)=>{"use strict";t.d(r,{Y9:()=>a,j2:()=>o});var s=t(7585),i=t(6814),n=t(8199);let u=new(t(6330)).PrismaClient,{handlers:a,auth:o,signIn:p,signOut:c}=(0,s.Ay)({adapter:(0,i.y)(u),providers:[(0,n.A)({server:{host:process.env.EMAIL_SERVER_HOST,port:Number(process.env.EMAIL_SERVER_PORT),auth:{user:process.env.EMAIL_SERVER_USER,pass:process.env.EMAIL_SERVER_PASSWORD}},from:process.env.EMAIL_FROM,maxAge:600})],pages:{signIn:"/auth/signin",verifyRequest:"/auth/verify-request",error:"/auth/error"},callbacks:{session:({session:e,user:r})=>({...e,user:{...e.user,id:r.id}})},session:{strategy:"jwt",maxAge:2592e3}})},7598:e=>{"use strict";e.exports=require("node:crypto")},7910:e=>{"use strict";e.exports=require("stream")},7975:e=>{"use strict";e.exports=require("node:util")},8033:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>q,routeModule:()=>d,serverHooks:()=>v,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{POST:()=>c});var i=t(2706),n=t(8203),u=t(5994),a=t(9187),o=t(7113);let p=new(t(6330)).PrismaClient;async function c(e,{params:r}){try{let e=await (0,o.j2)();if(!e||!e.user)return a.NextResponse.json({message:"Unauthorized"},{status:401});let{id:t}=r,s=await p.event.findUnique({where:{id:t},include:{_count:{select:{attendances:!0}}}});if(!s)return a.NextResponse.json({message:"Event not found"},{status:404});if(null!==s.capacity&&s._count.attendances>=s.capacity)return a.NextResponse.json({message:"This event is at capacity"},{status:400});if(await p.attendance.findUnique({where:{eventId_userId:{eventId:t,userId:e.user.id}}}))return a.NextResponse.json({message:"You are already attending this event"},{status:400});let i=await p.attendance.create({data:{event:{connect:{id:t}},user:{connect:{id:e.user.id}},status:"confirmed"}});return a.NextResponse.json(i,{status:201})}catch(e){return console.error("Error joining event:",e),a.NextResponse.json({message:"Internal server error"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/events/[id]/join/route",pathname:"/api/events/[id]/join",filename:"route",bundlePath:"app/api/events/[id]/join/route"},resolvedPagePath:"C:\\Users\\steve\\eventmaker\\app\\api\\events\\[id]\\join\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:l,serverHooks:v}=d;function q(){return(0,u.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:l})}},8335:()=>{},8354:e=>{"use strict";e.exports=require("util")},9021:e=>{"use strict";e.exports=require("fs")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")},9646:e=>{"use strict";e.exports=require("child_process")}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,452,820],()=>t(8033));module.exports=s})();